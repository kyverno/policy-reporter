{"_path":"/kyverno-plugin/api-reference","_dir":"kyverno-plugin","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"API Reference","description":"","position":30,"category":"Kyverno Plugin","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"api-reference"},"children":[{"type":"text","value":"API Reference"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Reference of all available HTTP endpoints provided by Policy Reporter."}]},{"type":"element","tag":"h2","props":{"id":"core-apis"},"children":[{"type":"text","value":"Core APIs"}]},{"type":"element","tag":"h3","props":{"id":"healthz-api"},"children":[{"type":"text","value":"Healthz API"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Method"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"API"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Codes"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"GET"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/healthz"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Returns if the app is healthy and required CRDs are installed"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"503"}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"example"},"children":[{"type":"text","value":"Example"}]},{"type":"element","tag":"code","props":{"code":"curl -X GET \"http://localhost:8080/healthz\"\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f4341"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"-X"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"GET"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"http://localhost:8080/healthz\""}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]}]}]},{"type":"element","tag":"code","props":{"code":"{}\n","language":"json","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"{}"}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"503"}]}]}]},{"type":"element","tag":"code","props":{"code":"{ \"error\": \"No Kyverno CRDs found\" }\n","language":"json","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"{ "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"error\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"No Kyverno CRDs found\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" }"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"readiness-api"},"children":[{"type":"text","value":"Readiness API"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Method"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"API"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Codes"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"GET"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/ready"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Returns if the app is up and running"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"example-1"},"children":[{"type":"text","value":"Example"}]},{"type":"element","tag":"code","props":{"code":"curl -X GET \"http://localhost:8080/ready\"\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f4341"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"-X"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"GET"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"http://localhost:8080/ready\""}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]}]}]},{"type":"element","tag":"code","props":{"code":"{}\n","language":"json","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"{}"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"crd-apis"},"children":[{"type":"text","value":"CRD APIs"}]},{"type":"element","tag":"h3","props":{"id":"policies-api"},"children":[{"type":"text","value":"Policies API"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Method"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"API"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Codes"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"GET"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/policies"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"List of all available Policies and ClusterPolicies"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"500"}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"example-2"},"children":[{"type":"text","value":"Example"}]},{"type":"element","tag":"code","props":{"code":"curl -X GET \"http://localhost:8080/policies\"\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f4341"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"-X"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"GET"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"http://localhost:8080/policies\""}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]}]}]},{"type":"element","tag":"code","props":{"code":"[\n   {\n      \"kind\":\"ClusterPolicy\",\n      \"name\":\"deny-privilege-escalation\",\n      \"autogenControllers\":[\n         \"DaemonSet\",\n         \"Deployment\",\n         \"Job\",\n         \"StatefulSet\",\n         \"CronJob\"\n      ],\n      \"validationFailureAction\":\"audit\",\n      \"background\":true,\n      \"rules\":[\n         {\n            \"message\":\"Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation, and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be undefined or set to `false`.\",\n            \"name\":\"deny-privilege-escalation\",\n            \"type\":\"validation\"\n         },\n         {\n            \"message\":\"Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation, and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be undefined or set to `false`.\",\n            \"name\":\"autogen-deny-privilege-escalation\",\n            \"type\":\"validation\"\n         },\n         {\n            \"message\":\"Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation, and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be undefined or set to `false`.\",\n            \"name\":\"autogen-cronjob-deny-privilege-escalation\",\n            \"type\":\"validation\"\n         }\n      ],\n      \"category\":\"Pod Security Standards (Restricted)\",\n      \"description\":\"Privilege escalation, such as via set-user-ID or set-group-ID file mode, should not be allowed.\",\n      \"severity\":\"medium\",\n      \"creationTimestamp\":\"2021-11-07T18:32:40Z\",\n      \"uid\":\"7cabc2f3-0e9b-4d1e-a434-a19275a54d29\",\n      \"content\":\"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  annotations:\\n    pod-policies.kyverno.io/autogen-controllers: DaemonSet,Deployment,Job,StatefulSet,CronJob\\n    policies.kyverno.io/category: Pod Security Standards (Restricted)\\n    policies.kyverno.io/description: Privilege escalation, such as via set-user-ID\\n      or set-group-ID file mode, should not be allowed.\\n    policies.kyverno.io/severity: medium\\n  creationTimestamp: \\\"2021-11-07T18:32:40Z\\\"\\n  generation: 16\\n  labels:\\n    app: kyverno\\n    app.kubernetes.io/component: kyverno\\n    app.kubernetes.io/instance: kyverno-policies\\n    app.kubernetes.io/managed-by: Helm\\n    app.kubernetes.io/name: kyverno-policies\\n    app.kubernetes.io/part-of: kyverno-policies\\n    app.kubernetes.io/version: v2.1.3\\n    argocd.argoproj.io/instance: kyverno-policies\\n    helm.sh/chart: kyverno-policies-v2.1.3\\n  name: deny-privilege-escalation\\n  resourceVersion: \\\"1742766\\\"\\n  uid: 7cabc2f3-0e9b-4d1e-a434-a19275a54d29\\nspec:\\n  background: true\\n  failurePolicy: Fail\\n  rules:\\n  - exclude:\\n      resources: {}\\n    generate:\\n      clone: {}\\n    match:\\n      resources:\\n        kinds:\\n        - Pod\\n    mutate: {}\\n    name: deny-privilege-escalation\\n    validate:\\n      message: Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation,\\n        and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be\\n        undefined or set to `false`.\\n      pattern:\\n        spec:\\n          =(initContainers):\\n          - =(securityContext):\\n              =(allowPrivilegeEscalation): \\\"false\\\"\\n          containers:\\n          - =(securityContext):\\n              =(allowPrivilegeEscalation): \\\"false\\\"\\n  - exclude:\\n      resources: {}\\n    generate:\\n      clone: {}\\n    match:\\n      resources:\\n        kinds:\\n        - DaemonSet\\n        - Deployment\\n        - Job\\n        - StatefulSet\\n    mutate: {}\\n    name: autogen-deny-privilege-escalation\\n    validate:\\n      message: Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation,\\n        and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be\\n        undefined or set to `false`.\\n      pattern:\\n        spec:\\n          template:\\n            spec:\\n              =(initContainers):\\n              - =(securityContext):\\n                  =(allowPrivilegeEscalation): \\\"false\\\"\\n              containers:\\n              - =(securityContext):\\n                  =(allowPrivilegeEscalation): \\\"false\\\"\\n  - exclude:\\n      resources: {}\\n    generate:\\n      clone: {}\\n    match:\\n      resources:\\n        kinds:\\n        - CronJob\\n    mutate: {}\\n    name: autogen-cronjob-deny-privilege-escalation\\n    validate:\\n      message: Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation,\\n        and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be\\n        undefined or set to `false`.\\n      pattern:\\n        spec:\\n          jobTemplate:\\n            spec:\\n              template:\\n                spec:\\n                  =(initContainers):\\n                  - =(securityContext):\\n                      =(allowPrivilegeEscalation): \\\"false\\\"\\n                  containers:\\n                  - =(securityContext):\\n                      =(allowPrivilegeEscalation): \\\"false\\\"\\n  validationFailureAction: audit\\n\"\n   }\n]\n","language":"json","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"["}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"   {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"kind\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"ClusterPolicy\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"deny-privilege-escalation\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"autogenControllers\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":["}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"DaemonSet\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Deployment\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Job\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"StatefulSet\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"CronJob\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      ],"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"validationFailureAction\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"audit\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"background\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"rules\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":["}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"message\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation, and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be undefined or set to `false`.\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"deny-privilege-escalation\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"type\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"validation\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         },"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"message\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation, and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be undefined or set to `false`.\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"autogen-deny-privilege-escalation\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"type\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"validation\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         },"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"message\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation, and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be undefined or set to `false`.\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"autogen-cronjob-deny-privilege-escalation\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"type\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"validation\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"         }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      ],"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"category\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Pod Security Standards (Restricted)\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"description\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Privilege escalation, such as via set-user-ID or set-group-ID file mode, should not be allowed.\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"severity\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"medium\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"creationTimestamp\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"2021-11-07T18:32:40Z\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"uid\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"7cabc2f3-0e9b-4d1e-a434-a19275a54d29\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"content\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"apiVersion: kyverno.io/v1"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"kind: ClusterPolicy"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"metadata:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  annotations:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    pod-policies.kyverno.io/autogen-controllers: DaemonSet,Deployment,Job,StatefulSet,CronJob"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    policies.kyverno.io/category: Pod Security Standards (Restricted)"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    policies.kyverno.io/description: Privilege escalation, such as via set-user-ID"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      or set-group-ID file mode, should not be allowed."}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    policies.kyverno.io/severity: medium"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  creationTimestamp: "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"2021-11-07T18:32:40Z"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  generation: 16"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  labels:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    app: kyverno"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    app.kubernetes.io/component: kyverno"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    app.kubernetes.io/instance: kyverno-policies"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    app.kubernetes.io/managed-by: Helm"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    app.kubernetes.io/name: kyverno-policies"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    app.kubernetes.io/part-of: kyverno-policies"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    app.kubernetes.io/version: v2.1.3"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    argocd.argoproj.io/instance: kyverno-policies"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    helm.sh/chart: kyverno-policies-v2.1.3"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  name: deny-privilege-escalation"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  resourceVersion: "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"1742766"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  uid: 7cabc2f3-0e9b-4d1e-a434-a19275a54d29"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"spec:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  background: true"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  failurePolicy: Fail"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  rules:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  - exclude:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      resources: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    generate:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      clone: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    match:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      resources:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        kinds:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        - Pod"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    mutate: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    name: deny-privilege-escalation"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    validate:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      message: Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation,"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        undefined or set to `false`."}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      pattern:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        spec:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"          =(initContainers):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"          - =(securityContext):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"              =(allowPrivilegeEscalation): "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"          containers:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"          - =(securityContext):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"              =(allowPrivilegeEscalation): "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  - exclude:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      resources: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    generate:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      clone: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    match:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      resources:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        kinds:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        - DaemonSet"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        - Deployment"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        - Job"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        - StatefulSet"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    mutate: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    name: autogen-deny-privilege-escalation"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    validate:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      message: Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation,"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        undefined or set to `false`."}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      pattern:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        spec:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"          template:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"            spec:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"              =(initContainers):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"              - =(securityContext):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                  =(allowPrivilegeEscalation): "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"              containers:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"              - =(securityContext):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                  =(allowPrivilegeEscalation): "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  - exclude:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      resources: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    generate:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      clone: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    match:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      resources:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        kinds:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        - CronJob"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    mutate: {}"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    name: autogen-cronjob-deny-privilege-escalation"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    validate:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      message: Privilege escalation is disallowed. The fields spec.containers[*].securityContext.allowPrivilegeEscalation,"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        and spec.initContainers[*].securityContext.allowPrivilegeEscalation must be"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        undefined or set to `false`."}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      pattern:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"        spec:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"          jobTemplate:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"            spec:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"              template:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                spec:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                  =(initContainers):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                  - =(securityContext):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                      =(allowPrivilegeEscalation): "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                  containers:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                  - =(securityContext):"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"                      =(allowPrivilegeEscalation): "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\""}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\\"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  validationFailureAction: audit"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"   }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"]"}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"500"}]}]}]},{"type":"element","tag":"code","props":{"code":"{ \"message\": \"Error Message\" }\n","language":"json","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"{ "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"message\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Error Message\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" }"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"verifyimage-rules-api"},"children":[{"type":"text","value":"VerifyImage Rules API"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Method"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"API"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Codes"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"GET"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/verify-image-rules"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"List of all VerifyImages rules applied to the cluster"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"500"}]}]}]}]}]},{"type":"element","tag":"h4","props":{"id":"example-3"},"children":[{"type":"text","value":"Example"}]},{"type":"element","tag":"code","props":{"code":"curl -X GET \"http://localhost:8080/verify-image-rules\"\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f4341"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"-X"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"GET"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"http://localhost:8080/verify-image-rules\""}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]}]}]},{"type":"element","tag":"code","props":{"code":"[\n    {\n        \"policy\": {\n            \"name\": \"check-image\",\n            \"uid\": \"b623d896-cfdb-4926-86c8-1bddaf93371f\"\n        },\n        \"rule\": \"check-image\",\n        \"repository\": \"registry.io/signatures\",\n        \"image\": \"ghcr.io/kyverno/test-verify-image:*\",\n        \"key\": \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8nXRh950IZbRj8Ra/N9sbqOPZrfM\\n5/KAQN0/KjHcorm/J5yctVd7iEcnessRQjU917hmKO6JWVGHpDguIyakZA==\\n-----END PUBLIC KEY-----\",\n        \"attestations\": \"attestations:\\n- conditions:\\n  - all:\\n    - key: '{{ repo.uri }}'\\n      operator: Equals\\n      value: https://git-repo.com/org/app\\n    - key: '{{ repo.branch }}'\\n      operator: Equals\\n      value: main\\n    - key: '{{ reviewers }}'\\n      operator: In\\n      value:\\n      - ana@example.com\\n      - bob@example.com\\n  predicateType: https://example.com/CodeReview/v1\\n\"\n    }\n]\n","language":"json","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"["}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"policy\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"check-image\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"uid\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"b623d896-cfdb-4926-86c8-1bddaf93371f\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"        },"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"rule\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"check-image\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"repository\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"registry.io/signatures\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"image\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"ghcr.io/kyverno/test-verify-image:*\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"key\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"-----BEGIN PUBLIC KEY-----"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8nXRh950IZbRj8Ra/N9sbqOPZrfM"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"5/KAQN0/KjHcorm/J5yctVd7iEcnessRQjU917hmKO6JWVGHpDguIyakZA=="}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"-----END PUBLIC KEY-----\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"attestations\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"attestations:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"- conditions:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  - all:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    - key: '{{ repo.uri }}'"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      operator: Equals"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      value: https://git-repo.com/org/app"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    - key: '{{ repo.branch }}'"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      operator: Equals"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      value: main"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"    - key: '{{ reviewers }}'"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      operator: In"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      value:"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      - ana@example.com"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"      - bob@example.com"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"  predicateType: https://example.com/CodeReview/v1"}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"]"}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"500"}]}]}]},{"type":"element","tag":"code","props":{"code":"{ \"message\": \"Error Message\" }\n","language":"json","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":"{ "}]},{"type":"element","tag":"span","props":{"class":"ct-09306f"},"children":[{"type":"text","value":"\"message\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"Error Message\""}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" }"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"metrics"},"children":[{"type":"text","value":"Metrics"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Method"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"API"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Codes"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"GET"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/metrics"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Prometheus Metrics API"}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"kyverno_policy"},"children":[{"type":"text","value":"kyverno_policy"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Gauge: One entry represents one "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Rule"}]},{"type":"text","value":" of a Policy or ClusterPolicy. Deleted policies and rules will also be removed from the metrics."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":null},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"background"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Background scan enabled or disabled"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"category"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Category of the policy"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"kind"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Policy or ClusterPolicy"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"namespace"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Namespace of the policy"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"policy"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Name of the policy"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"rule"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Name of the rule within the policy"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"rule"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Rule of the result"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"severity"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Severity of the policy"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"type"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"Type of the rule: validation / mutation / generation"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"validationFailureAction"}]}]},{"type":"element","tag":"td","props":{"align":null},"children":[{"type":"text","value":"validationFailureAction of the rule: audit / enforce"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"example-4"},"children":[{"type":"text","value":"Example"}]},{"type":"element","tag":"code","props":{"code":"curl -X GET \"http://localhost:8080/metrics\"\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f4341"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e1190e"},"children":[{"type":"text","value":"-X"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"GET"}]},{"type":"element","tag":"span","props":{"class":"ct-c90156"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-71b590"},"children":[{"type":"text","value":"\"http://localhost:8080/metrics\""}]}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Response "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"200"}]}]}]},{"type":"element","tag":"code","props":{"code":"# HELP policy_report_kyverno_policy List of all Policies\n# TYPE policy_report_kyverno_policy gauge\nkyverno_policy{background=\"true\",category=\"\",kind=\"ClusterPolicy\",namespace=\"\",policy=\"require-ns-labels\",rule=\"check-for-labels-on-namespace\",severity=\"\",type=\"validation\",validationFailureAction=\"audit\"} 1\nkyverno_policy{background=\"true\",category=\"Pod Security Standards (Default)\",kind=\"ClusterPolicy\",namespace=\"\",policy=\"disallow-add-capabilities\",rule=\"autogen-capabilities\",severity=\"medium\",type=\"validation\",validationFailureAction=\"audit\"} 1\nkyverno_policy{background=\"true\",category=\"Pod Security Standards (Default)\",kind=\"ClusterPolicy\",namespace=\"\",policy=\"disallow-add-capabilities\",rule=\"autogen-cronjob-capabilities\",severity=\"medium\",type=\"validation\",validationFailureAction=\"audit\"} 1\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# HELP policy_report_kyverno_policy List of all Policies\n# TYPE policy_report_kyverno_policy gauge\nkyverno_policy{background=\"true\",category=\"\",kind=\"ClusterPolicy\",namespace=\"\",policy=\"require-ns-labels\",rule=\"check-for-labels-on-namespace\",severity=\"\",type=\"validation\",validationFailureAction=\"audit\"} 1\nkyverno_policy{background=\"true\",category=\"Pod Security Standards (Default)\",kind=\"ClusterPolicy\",namespace=\"\",policy=\"disallow-add-capabilities\",rule=\"autogen-capabilities\",severity=\"medium\",type=\"validation\",validationFailureAction=\"audit\"} 1\nkyverno_policy{background=\"true\",category=\"Pod Security Standards (Default)\",kind=\"ClusterPolicy\",namespace=\"\",policy=\"disallow-add-capabilities\",rule=\"autogen-cronjob-capabilities\",severity=\"medium\",type=\"validation\",validationFailureAction=\"audit\"} 1"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-09306f{color:#116329}\n.ct-71b590{color:#0A3069}\n.ct-e1190e{color:#0550AE}\n.ct-c90156{color:#24292F}\n.ct-6f4341{color:#953800}\n.dark .ct-6f4341{color:#FFA657}\n.dark .ct-c90156{color:#C9D1D9}\n.dark .ct-e1190e{color:#79C0FF}\n.dark .ct-71b590{color:#A5D6FF}\n.dark .ct-09306f{color:#7EE787}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"core-apis","depth":2,"text":"Core APIs","children":[{"id":"healthz-api","depth":3,"text":"Healthz API"},{"id":"readiness-api","depth":3,"text":"Readiness API"}]},{"id":"crd-apis","depth":2,"text":"CRD APIs","children":[{"id":"policies-api","depth":3,"text":"Policies API"},{"id":"verifyimage-rules-api","depth":3,"text":"VerifyImage Rules API"}]},{"id":"metrics","depth":2,"text":"Metrics","children":[{"id":"kyverno_policy","depth":3,"text":"kyverno_policy"},{"id":"example-4","depth":3,"text":"Example"}]}]}},"_type":"markdown","_id":"content:04. kyverno-plugin:api-reference.md","_source":"content","_file":"04. kyverno-plugin/api-reference.md","_extension":"md"}