{"_path":"/guide/migration","_dir":"guide","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Migration Guide","description":"Migration between Major Versions","position":5,"category":"Guide","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"migration-guide"},"children":[{"type":"text","value":"Migration Guide"}]},{"type":"element","tag":"h2","props":{"id":"policy-reporter"},"children":[{"type":"text","value":"Policy Reporter"}]},{"type":"element","tag":"h3","props":{"id":"deprecations"},"children":[{"type":"text","value":"Deprecations"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Deprecated values are removed"}]},{"type":"element","tag":"code","props":{"code":"- crdVersion: v1alpha1\n- cleanupDebounceTime: 20\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"- crdVersion: v1alpha1"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"- cleanupDebounceTime: 20"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"yandex-push-target"},"children":[{"type":"text","value":"Yandex push target"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Changed into a general S3 Target."}]},{"type":"element","tag":"code","props":{"code":"target:\n-  yandex:\n-    accessKeyID: \"\"\n-    secretAccessKey: \"\"\n-    region: \"\"\n-    endpoint: \"\"\n-    bucket: \"\"\n-    prefix: \"\"\n-    minimumPriority: \"\"\n-    skipExistingOnStartup: true\n+  s3:\n+    accessKeyID: \"\"\n+    secretAccessKey: \"\"\n+    region: \"ru-central1\"\n+    endpoint: \"https://storage.yandexcloud.net\"\n+    bucket: \"\"\n+    prefix: \"\"\n+    minimumPriority: \"\"\n+    sources: []\n+    skipExistingOnStartup: true\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6891aa"},"children":[{"type":"text","value":"target:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-  yandex:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    accessKeyID: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    secretAccessKey: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    region: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    endpoint: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    bucket: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    prefix: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    minimumPriority: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    skipExistingOnStartup: true"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+  s3:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    accessKeyID: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    secretAccessKey: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    region: \"ru-central1\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    endpoint: \"https://storage.yandexcloud.net\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    bucket: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    prefix: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    minimumPriority: \"\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    sources: []"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    skipExistingOnStartup: true"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"metrics-api"},"children":[{"type":"text","value":"Metrics API"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Metrics are now optional and disabled by default. They are enabled if you use the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"monitoring"}]},{"type":"text","value":" subchart. Otherwise, you need to enable them separately."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Metrics are now using the same HTTP Server as the REST APIs ("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":" instead of "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"2112"}]},{"type":"text","value":")."}]},{"type":"element","tag":"code","props":{"code":"+ metrics:\n+    enabled: true\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+ metrics:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    enabled: true"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"rest-apis"},"children":[{"type":"text","value":"REST APIs"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"REST APIs are now optional and disabled by default. They are enabled if you use the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ui"}]},{"type":"text","value":" subchart. Otherwise, you need to enable them separately."}]},{"type":"element","tag":"code","props":{"code":"+ rest:\n+    enabled: true\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+ rest:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    enabled: true"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"network-policy"},"children":[{"type":"text","value":"Network Policy"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Egress traffic is now configured as default egress rule instead of the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"networkPolicy.kubernetesApiPort"}]},{"type":"text","value":" value."}]},{"type":"element","tag":"code","props":{"code":"networkPolicy:\n  enabled: true\n-  kubernetesApiPort: 6443\n-  egress: []\n+  egress:\n+  - to:\n+    ports:\n+    - protocol: TCP\n+      port: 6443\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6891aa"},"children":[{"type":"text","value":"networkPolicy:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6891aa"},"children":[{"type":"text","value":"  enabled: true"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-  kubernetesApiPort: 6443"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-  egress: []"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+  egress:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+  - to:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    ports:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    - protocol: TCP"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+      port: 6443"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"priority-mapping"},"children":[{"type":"text","value":"Priority mapping"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The watch feature was removed, so it is enabled by default. Its recommended to use the severity of your policy to define the priority."}]},{"type":"element","tag":"code","props":{"code":"- policyPriorities:\n-   enabled: false\n-   mapping: {}\n+ policyPriorities: {}\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"- policyPriorities:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-   enabled: false"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-   mapping: {}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+ policyPriorities: {}"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"kyverno-plugin"},"children":[{"type":"text","value":"Kyverno Plugin"}]},{"type":"element","tag":"h3","props":{"id":"network-policy-1"},"children":[{"type":"text","value":"Network Policy"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Egress traffic is now configured as default egress rule instead of the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"kyvernoPlugin.networkPolicy.kubernetesApiPort"}]},{"type":"text","value":" value."}]},{"type":"element","tag":"code","props":{"code":"kyvernoPlugin:\n  networkPolicy:\n    enabled: true\n-    kubernetesApiPort: 6443\n-    egress: []\n+    egress:\n+    - to:\n+      ports:\n+      - protocol: TCP\n+        port: 6443\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6891aa"},"children":[{"type":"text","value":"kyvernoPlugin:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6891aa"},"children":[{"type":"text","value":"  networkPolicy:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6891aa"},"children":[{"type":"text","value":"    enabled: true"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    kubernetesApiPort: 6443"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-    egress: []"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    egress:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+    - to:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+      ports:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+      - protocol: TCP"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+        port: 6443"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"monitoring"},"children":[{"type":"text","value":"Monitoring"}]},{"type":"element","tag":"h3","props":{"id":"namespace"},"children":[{"type":"text","value":"Namespace"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Namespace configuration for the Grafana Dashboard ConfigMaps moved from "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"monitoring.namespace"}]},{"type":"text","value":" to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"monitoring.grafana.namespace"}]},{"type":"text","value":" and has no default value as before."}]},{"type":"element","tag":"code","props":{"code":"monitoring:\n-   namespace: cattle-dashboards\n+   grafana:\n+     namespace: cattle-dashboards\n","language":"diff","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6891aa"},"children":[{"type":"text","value":"monitoring:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-868d0e"},"children":[{"type":"text","value":"-   namespace: cattle-dashboards"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+   grafana:"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c4e68"},"children":[{"type":"text","value":"+     namespace: cattle-dashboards"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-9c4e68{color:#116329}\n.ct-6891aa{color:#24292F}\n.ct-868d0e{color:#82071E}\n.dark .ct-868d0e{color:#FFA198}\n.dark .ct-6891aa{color:#C9D1D9}\n.dark .ct-9c4e68{color:#7EE787}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"policy-reporter","depth":2,"text":"Policy Reporter","children":[{"id":"deprecations","depth":3,"text":"Deprecations"},{"id":"yandex-push-target","depth":3,"text":"Yandex push target"},{"id":"metrics-api","depth":3,"text":"Metrics API"},{"id":"rest-apis","depth":3,"text":"REST APIs"},{"id":"network-policy","depth":3,"text":"Network Policy"},{"id":"priority-mapping","depth":3,"text":"Priority mapping"}]},{"id":"kyverno-plugin","depth":2,"text":"Kyverno Plugin","children":[{"id":"network-policy-1","depth":3,"text":"Network Policy"}]},{"id":"monitoring","depth":2,"text":"Monitoring","children":[{"id":"namespace","depth":3,"text":"Namespace"}]}]}},"_type":"markdown","_id":"content:01. guide:migration.md","_source":"content","_file":"01. guide/migration.md","_extension":"md"}